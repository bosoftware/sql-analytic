<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>SQLODataService UI</title>
<link rel="stylesheet" type="text/css" href="css/style.css">
<script type="text/javascript" src="js/util.js"></script>
<script type="text/javascript" src="js/metadata.js"></script>
<script type="text/javascript" src="js/service.js"></script>
</head>
<body>
	<script type="text/javascript" id="buildMenu">
		window.$metadata = new ServiceMetadata(
				"http://localhost:8080/sql-odata-web/SQLODataService.svc",
				function(metadata) {
					var list = "<ul>";
					for (e in metadata.entitySets) {
						var handler = "buildDataTable('{0}')".format(e);
						list += "<li><a href=\"#\" onClick=\"{0}\">{1}</a></li>"
								.format(handler, e);
					}
					list += "</ul>";
					var menu = document.getElementById("menu");
					menu.innerHTML = list;
					window.$service = new Service($metadata);
				});
	</script>
	<script type="text/javascript" id="buildDataTable">
		function buildDataTable(eSetName) {
			$service.getEntitySet(eSetName, function(data, entityType) {
				var dataTable = "<table><thead><tr>";
				var colCount = 0;
				for (p in entityType.properties) {
					dataTable += "<th>{0}</th>".format(p);
					colCount++;
				}
				dataTable += "</thead></tr><tbody>";
				for (var i in data.value) {
					var row = data.value[i];
					if (i % 2 == 1) {
						dataTable += "<tr>";
					} else {
						dataTable += "<tr class=\"alt\">";
					}
					for (col in row) {
						dataTable += "<td>{0}</td>".format(row[col]);
					}
					dataTable += "</tr>";
				}
				dataTable += "</tbody>";
				dataTable += document.getElementById("dataTableFoot").innerHTML.format(colCount) ;
				dataTable += "</table>";
				document.getElementById("dataTable").innerHTML = dataTable;
			});
		}
	</script>
	<script type="text/template" id="dataTableFoot">
	<tfoot>
		<tr>
			<td colspan="{0}">
				<div id="paging">
					<ul>
						<li><a href="#"><span>Previous</span></a></li>
						<li><a href="#" class="active"><span>1</span></a></li>
						<li><a href="#"><span>2</span></a></li>
						<li><a href="#"><span>3</span></a></li>
						<li><a href="#"><span>4</span></a></li>
						<li><a href="#"><span>5</span></a></li>
						<li><a href="#"><span>Next</span></a></li>
					</ul>
				</div>
		</tr>
	</tfoot>
	</script>

	<div id="menu"></div>
	<div id="dataTable" class="datagrid"></div>

</body>
</html>
